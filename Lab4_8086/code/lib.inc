DEFINE_CREATE_HEX MACRO

JMP skip_proc_create_hex

;DIAVAZW TON ARITHMO POU DINETAI MESW TOY AX KAI TON PROSTHETW KATALLHLA STON TELIKO BX 
CREATE_HEX PROC NEAR	
	MOV AH,0
	XCHG AX,BX      ;ANTALLAGH PERIEXOMENWN TWN AX,BX
	MOV DX,16D      ;KANW 1 SHIFT LEFT SE HEX ARITHMO
	MUL DX		
	ADD BX,AX       ;PROSTHETW AUTON P DIAVASA KAI EXW ETOIMO TON HEX STON BX
	RET
CREATE_HEX ENDP

skip_proc_create_hex:
DEFINE_CREATE_HEX ENDM


DEFINE_PRINT_DEC MACRO
LOCAL ADR2,ADR3

JMP skip_proc_print_dec
	
PRINT_DEC PROC NEAR
	MOV CX,0       ;COUNTER OF DIGITS
	MOV AX,DX      ;AX=ARITHMOS PROS EMFANISI
ADR2:
	MOV DX,0
	MOV BX,10
	DIV BX         ;DIAIRW ME TO 10 KAI A=ADIV10 KAI D=AMOD10
	PUSH DX        ;APOTHIKEUW TO MOD STO STACK
	INC CX         ;DIGITS++
	CMP AX,0       ;AN TELEIWSE O ARITHMOS TOTE FUGE
	JNZ ADR2       ;ALLIWS SUNEXISE NA SPAS STA PSHFIA
ADR3:
	POP DX         ;KANW POP OSES FORES LEEI O CX                         
	ADD DX,30H     ;KANTON ASCII
	PRINT DL       ;KAI TYPWSE TON
	LOOP ADR3 
	RET
PRINT_DEC ENDP

skip_proc_print_dec:
DEFINE_PRINT_DEC ENDM



DEFINE_READ_HEX MACRO
LOCAL IGNORE,ITSNUM,ITSLETTER,ADRR1,ADRR2

JMP skip_proc_read_hex
	
;ROUTINA POU DIABASEI ENA HEX PSHFIO KAI TO EPISTREFEI WS DYADIKO MESW TOY AL	
READ_HEX PROC NEAR	
	PUSH DX
IGNORE:
	CMP AL,30H      ;AN EINAI <0 TOTE IGNORE
	JL ADRR1
	CMP AL,46H      ;AN EINAI >F TOTE IGNORE
	JG ADRR1
	CMP AL,41H      ;AN EINAI APO A EWS F TOTE EINAI LETTER
	JGE ITSLETTER
	CMP AL,39H      ;AN EINAI APO 0 EWS 9 TOTE EINAI NUM                            
	JLE ITSNUM
	JMP ADRR1       ;ALLIWS IGNORE
ITSNUM:
   	PUSH AX
	PRINT AL        ;PRINT TON NUM
	POP AX
	SUB AL,30H      ;DIORTHWSH TOU NUM SE DUADIKI MORFH
	CALL CREATE_HEX ;KANTO PSHFIO HEX
	JMP ADRR2 
ITSLETTER:          
   	PUSH AX
	PRINT AL        ;PRINT TO LETTER
	POP AX
	SUB AL,37H      ;DIORTHWSH TOU LETTER SE DUADUKI MORFH
	CALL CREATE_HEX ;KANTO PSHFIO HEX
	JMP ADRR2
ADRR1:
	INC CX          ;!!KANTO +1 XEIROKINHTA GT DEN PIANETAI GIA PSHFIO POU DIAVASA
ADRR2:
	POP DX
	RET
READ_HEX ENDP
	

skip_proc_read_hex:
DEFINE_READ_HEX ENDM




DEFINE_PRINT_HEX1 MACRO
LOCAL ADRR4,ADRR5

JMP skip_proc_print_hex1
	
PRINT_HEX1 PROC NEAR  ; H PRINT_HEX1 EKTYPWNEI TA 4LSB TOU DL WS HEX PSHFIO
	PUSH DX
	CMP DL,9            ;AN >9 TOTE EINAI LETTER
	JG ADDR4
	ADD DL,30H          ;ALLIWS EINAI DIGIT
	JMP ADDR5
ADDR4:
	ADD DL,37H
ADDR5:
	PRINT DL
	POP DX
	RET
PRINT_HEX1 ENDP

skip_proc_print_hex1:
DEFINE_PRINT_HEX1 ENDM



DEFINE_PRINT_HEX MACRO

JMP skip_proc_print_hex
	
PRINT_HEX PROC NEAR ; H ROYTINA PRINT_HEX EKTYPWNEI WS HEX TO ORISMA POU THS DINETAI MESW TOY DL
	PUSH AX
	PUSH CX
	MOV AL,DL       ;A EXEI TON ARITHMO 
	AND DL,0F0H     ;KRATAW TA 4 MSB
	MOV CL,4
	RCR DL,CL       ;4 SHIFTS DEKSIA
	CALL PRINT_HEX1 ;TYPWSE TA
	MOV DL,AL       
	AND DL,0FH      ;TWRA KRATAW TA 4 LSB
	CALL PRINT_HEX1 ;KAI TA TYPWNW
	POP CX
	POP AX
	RET
PRINT_HEX ENDP
	
skip_proc_print_hex:
DEFINE_PRINT_HEX ENDM


DEFINE_PRINT32 MACRO


JMP skip_proc_print32
	
PRINT32 PROC NEAR
   PUSH DX
   XCHG DL,DH
   CALL PRINT_HEX
   XCHG DL,DH
   CALL PRINT_HEX
   POP DX
   RET
PRINT32 ENDP
	
skip_proc_print32:
DEFINE_PRINT32 ENDM


